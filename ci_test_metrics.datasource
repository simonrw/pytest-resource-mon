TOKEN ci-token APPEND

DESCRIPTION >
    Per-test system resource snapshots from CI pytest runs

SCHEMA >
    `event_type` String `json:$.event_type`,
    `test_nodeid` String `json:$.test_nodeid`,
    `timestamp` DateTime64(3) `json:$.timestamp`,
    `batch_num` Nullable(Int32) `json:$.batch_num`,
    `duration_s` Nullable(Float64) `json:$.duration_s`,
    `cpu_before` Nullable(Float64) `json:$.cpu_before`,
    `cpu_after` Nullable(Float64) `json:$.cpu_after`,
    `cpu_count` Nullable(Int32) `json:$.cpu_count`,
    `mem_total_bytes` Nullable(Int64) `json:$.mem_total_bytes`,
    `mem_available_before` Nullable(Int64) `json:$.mem_available_before`,
    `mem_available_after` Nullable(Int64) `json:$.mem_available_after`,
    `mem_percent_before` Nullable(Float64) `json:$.mem_percent_before`,
    `mem_percent_after` Nullable(Float64) `json:$.mem_percent_after`,
    `disk_total_bytes` Nullable(Int64) `json:$.disk_total_bytes`,
    `disk_free_before` Nullable(Int64) `json:$.disk_free_before`,
    `disk_free_after` Nullable(Int64) `json:$.disk_free_after`,
    `disk_percent_before` Nullable(Float64) `json:$.disk_percent_before`,
    `disk_percent_after` Nullable(Float64) `json:$.disk_percent_after`,
    `exit_status` Nullable(Int32) `json:$.exit_status`,
    `gh_run_id` String `json:$.gh_run_id`,
    `gh_sha` String `json:$.gh_sha`,
    `gh_ref_name` String `json:$.gh_ref_name`,
    `gh_workflow` String `json:$.gh_workflow`,
    `gh_job` String `json:$.gh_job`,
    `gh_actor` String `json:$.gh_actor`,
    `gh_repository` String `json:$.gh_repository`,
    `gh_run_attempt` String `json:$.gh_run_attempt`

ENGINE "MergeTree"
ENGINE_SORTING_KEY "timestamp, test_nodeid"

FORWARD_QUERY >
  SELECT event_type, test_nodeid, timestamp, CAST(batch_num, 'Nullable(Int32)') AS batch_num, CAST(duration_s, 'Nullable(Float64)') AS duration_s, CAST(cpu_before, 'Nullable(Float64)') AS cpu_before, CAST(cpu_after, 'Nullable(Float64)') AS cpu_after, CAST(cpu_count, 'Nullable(Int32)') AS cpu_count, CAST(mem_total_bytes, 'Nullable(Int64)') AS mem_total_bytes, CAST(mem_available_before, 'Nullable(Int64)') AS mem_available_before, CAST(mem_available_after, 'Nullable(Int64)') AS mem_available_after, CAST(mem_percent_before, 'Nullable(Float64)') AS mem_percent_before, CAST(mem_percent_after, 'Nullable(Float64)') AS mem_percent_after, CAST(disk_total_bytes, 'Nullable(Int64)') AS disk_total_bytes, CAST(disk_free_before, 'Nullable(Int64)') AS disk_free_before, CAST(disk_free_after, 'Nullable(Int64)') AS disk_free_after, CAST(disk_percent_before, 'Nullable(Float64)') AS disk_percent_before, CAST(disk_percent_after, 'Nullable(Float64)') AS disk_percent_after, CAST(exit_status, 'Nullable(Int32)') AS exit_status, gh_run_id, gh_sha, gh_ref_name, gh_workflow, gh_job, gh_actor, gh_repository, gh_run_attempt

